<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casino Snake Game</title>
    <style>
        body {
            background-color: #000000;
            font-family: 'Arial', sans-serif;
            color: #ffffff;
        }
        .wrap {
            margin-left: auto;
            margin-right: auto;
        }

        canvas {
            display: none;
            border-style: solid;
            border-width: 10px;
            border-color: #FFD700;
        }

        canvas:focus {
            outline: none;
        }

        /* Main Menu Styling */
        #menu {
            display: block;
            text-align: center;
            color: #FFD700;
            font-family: 'Arial', sans-serif;
        }

        #gameover {
            display: none;
            text-align: center;
            color: #FFD700;
        }

        #setting {
            display: none;
            text-align: center;
            color: #FFD700;
        }

        #gameover p, #setting p, #menu p {
            font-size: 20px;
            font-weight: bold;
            text-shadow: 2px 2px 5px rgba(255, 215, 0, 0.7);
        }

        #gameover a, #setting a, #menu a {
            font-size: 30px;
            color: #FF6347;
            text-decoration: none;
            display: block;
            margin-top: 20px;
            padding: 15px;
            background-color: #008000;
            border-radius: 10px;
            box-shadow: 0px 4px 15px rgba(255, 215, 0, 0.5);
        }

        #gameover a:hover, #setting a:hover, #menu a:hover {
            cursor: pointer;
            background-color: #FFD700;
            color: #ffffff;
        }

        #gameover a:hover::before, #setting a:hover::before, #menu a:hover::before {
            content: ">";
            margin-right: 10px;
        }

        #score_value {
            font-size: 2em;
            color: #FF6347;
            text-shadow: 2px 2px 5px rgba(255, 215, 0, 0.7);
        }

        /* Button Styling */
        button {
            padding: 15px;
            margin-top: 20px;
            background-color: #32CD32;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
        }

        button:hover {
            background-color: #FFD700;
            transition: 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="pb-3 mb-4 border-bottom border-primary text-dark">
            <p class="fs-4">Snake score: <span id="score_value">0</span></p>
        </header>
        <div class="container bg-secondary" style="text-align:center;">
            <!-- Main Menu -->
            <div id="menu" class="py-4 text-light">
                <p>Welcome to Snake, press  <span style="background-color: #ff5ed4; color: #ffffff">space</span> to begin</p>
                <a id="new_game" class="link-alert">new game</a>
                <a id="setting_menu" class="link-alert">settings</a>
            </div>
            <!-- Game Over -->
            <div id="gameover" class="py-4 text-light">
                <p>Game Over, press <span style="background-color: #ff5ed4; color: #ffffff">space</span> to try again</p>
                <a id="new_game1" class="link-alert">new game</a>
                <a id="setting_menu1" class="link-alert">settings</a>
            </div>
            <!-- Play Screen -->
            <canvas id="snake" class="wrap" width="320" height="320" tabindex="1"></canvas>
            <!-- Settings Screen -->
            <div id="setting" class="py-4 text-light">
                <p>Settings Screen, press <span style="background-color: #edc43b; color: #FFFFFF">space</span> to go back to playing</p>
                <a id="new_game2" class="link-alert">new game</a>
                <br>
                <p>Speed:
                    <input id="speed1" type="radio" name="speed" value="120" checked/>
                    <label for="speed1">Slow</label>
                    <input id="speed2" type="radio" name="speed" value="75"/>
                    <label for="speed2">Normal</label>
                    <input id="speed3" type="radio" name="speed" value="35"/>
                    <label for="speed3">Fast</label>
                </p>
                <p>Wall:
                    <input id="wallon" type="radio" name="wall" value="1" checked/>
                    <label for="wallon">On</label>
                    <input id="walloff" type="radio" name="wall" value="0"/>
                    <label for="walloff">Off</label>
                </p>
            </div>
        </div>
    </div>

    <script>
        (function(){
            /* Attributes of Game */
            /////////////////////////////////////////////////////////////
            // Canvas & Context
            const canvas = document.getElementById("snake");
            const ctx = canvas.getContext("2d");
            // HTML Game IDs
            const SCREEN_SNAKE = 0;
            const screen_snake = document.getElementById("snake");
            const ele_score = document.getElementById("score_value");
            const speed_setting = document.getElementsByName("speed");
            const wall_setting = document.getElementsByName("wall");
            // HTML Screen IDs (div)
            const SCREEN_MENU = -1, SCREEN_GAME_OVER=1, SCREEN_SETTING=2;
            const screen_menu = document.getElementById("menu");
            const screen_game_over = document.getElementById("gameover");
            const screen_setting = document.getElementById("setting");
            // HTML Event IDs (a tags)
            const button_new_game = document.getElementById("new_game");
            const button_new_game1 = document.getElementById("new_game1");
            const button_new_game2 = document.getElementById("new_game2");
            const button_setting_menu = document.getElementById("setting_menu");
            const button_setting_menu1 = document.getElementById("setting_menu1");
            // Game Control
            const BLOCK = 10;   // size of block rendering
            let SCREEN = SCREEN_MENU;
            let snake;
            let snake_dir;
            let snake_next_dir;
            let snake_speed;
            let food = {x: 0, y: 0};
            let score;
            let wall;
            /* Display Control */
            /////////////////////////////////////////////////////////////
            // 0 for the game
            // 1 for the main menu
            // 2 for the settings screen
            // 3 for the game over screen
            let showScreen = function(screen_opt){
                SCREEN = screen_opt;
                switch(screen_opt){
                    case SCREEN_SNAKE:
                        screen_snake.style.display = "block";
                        screen_menu.style.display = "none";
                        screen_setting.style.display = "none";
                        screen_game_over.style.display = "none";
                        break;
                    case SCREEN_GAME_OVER:
                        screen_snake.style.display = "block";
                        screen_menu.style.display = "none";
                        screen_setting.style.display = "none";
                        screen_game_over.style.display = "block";
                        break;
                    case SCREEN_SETTING:
                        screen_snake.style.display = "none";
                        screen_menu.style.display = "none";
                        screen_setting.style.display = "block";
                        screen_game_over.style.display = "none";
                        break;
                }
            }
            /* Actions and Events  */
            /////////////////////////////////////////////////////////////
            window.onload = function(){
                // HTML Events to Functions
                button_new_game.onclick = function(){newGame();};
                button_new_game1.onclick = function(){newGame();};
                button_new_game2.onclick = function(){newGame();};
                button_setting_menu.onclick = function(){showScreen(SCREEN_SETTING);};
                button_setting_menu1.onclick = function(){showScreen(SCREEN_SETTING);};
                // speed
                setSnakeSpeed(150);
                for(let i = 0; i < speed_setting.length; i++){
                    speed_setting[i].addEventListener("click", function(){
                        for(let i = 0; i < speed_setting.length; i++){
                            if(speed_setting[i].checked){
                                setSnakeSpeed(speed_setting[i].value);
                            }
                        }
                    });
                }
                // wall setting
                setWall(1);
                for(let i = 0; i < wall_setting.length; i++){
                    wall_setting[i].addEventListener("click", function(){
                        for(let i = 0; i < wall_setting.length; i++){
                            if(wall_setting[i].checked){
                                setWall(wall_setting[i].value);
                            }
                        }
                    });
                }
                // activate window events
                window.addEventListener("keydown", function(evt) {
                    // spacebar detected
                    if(evt.code === "Space" && SCREEN !== SCREEN_SNAKE)
                        newGame();
                }, true);
            }
            /* Snake is on the Go (Driver Function)  */
            /////////////////////////////////////////////////////////////
            let mainLoop = function(){
                let _x = snake[0].x;
                let _y = snake[0].y;
                snake_dir = snake_next_dir;   // read async event key
                // Direction 0 - Up, 1 - Right, 2 - Down, 3 - Left
                switch(snake_dir){
                    case 0: _y--; break;
                    case 1: _x++; break;
                    case 2: _y++; break;
                    case 3: _x--; break;
                }
                snake.pop(); // tail is removed
                snake.unshift({x: _x, y: _y}); // head is new in new position/orientation
                // Wall Checker
                if(wall === 1){
                    // Wall on, Game over test
                    if (snake[0].x < 0 || snake[0].y < 0 || snake[0].x > canvas.width / BLOCK || snake[0].y > canvas.height / BLOCK) {
                        gameOver();
                        return;
                    }
                }
                // Self Collision Check
                for(let i = 1; i < snake.length; i++){
                    if(snake[0].x === snake[i].x && snake[0].y === snake[i].y){
                        gameOver();
                        return;
                    }
                }
                // Food Collision Check
                if(snake[0].x === food.x && snake[0].y === food.y){
                    score += 10;
                    food = createFood();
                    snake.push({});  // Grow snake
                    ele_score.innerHTML = score;
                }
                // Draw on the Canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);  // clear screen
                drawFood(food.x, food.y);
                drawSnake();
                setTimeout(mainLoop, snake_speed);  // recurs main loop with delay
            }
            /* Draw Snake */
            /////////////////////////////////////////////////////////////
            let drawSnake = function(){
                for(let i = 0; i < snake.length; i++){
                    ctx.fillStyle = "#FF6347";  // snake color
                    ctx.fillRect(snake[i].x * BLOCK, snake[i].y * BLOCK, BLOCK, BLOCK);  // draw each segment
                }
            }
            /* Create Food */
            /////////////////////////////////////////////////////////////
            let createFood = function(){
                let _food = {
                    x: Math.floor(Math.random() * canvas.width / BLOCK),
                    y: Math.floor(Math.random() * canvas.height / BLOCK)
                };
                return _food;
            }
            let drawFood = function(x, y){
                ctx.fillStyle = "#FFD700";  // food color
                ctx.fillRect(x * BLOCK, y * BLOCK, BLOCK, BLOCK);
            }
            /* Game Over */
            /////////////////////////////////////////////////////////////
            let gameOver = function(){
                showScreen(SCREEN_GAME_OVER);
            }
            /* New Game */
            /////////////////////////////////////////////////////////////
            let newGame = function(){
                snake = [{x: 5, y: 5}];
                snake_dir = 1;
                snake_next_dir = 1;
                score = 0;
                food = createFood();
                ele_score.innerHTML = score;
                showScreen(SCREEN_SNAKE);
                mainLoop();
            }
            /* Speed Setting */
            /////////////////////////////////////////////////////////////
            let setSnakeSpeed = function(speed){
                snake_speed = parseInt(speed);
            }
            /* Wall Setting */
            /////////////////////////////////////////////////////////////
            let setWall = function(wall_opt){
                wall = wall_opt;
            }
        })();
    </script>
</body>
</html>